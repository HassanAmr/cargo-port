<!DOCTYPE html>
<html>
    <head>
        <title>Galaxyproject: The Cargo Port</title>

        <link rel="stylesheet" href="static/bootstrap.min.css"
            integrity="sha512-7/D5UU6BeayPQB5Wcu5scGLLOPwjCAdLdd4AdRfmxPcmUDCmEuxiKYCB/oOQ6zdG65RVEfri7FD55YZ0TVrW6w=="
            crossorigin="anonymous">
        <link rel="stylesheet" href="static/bootstrap-theme.min.css"
            integrity="sha512-w+Sssgbbch2/RCvDaNotvccV897aLJZ++WNuj34R4EGj5V/O0jrOFkJyivcVF+yFcCPsmYxe7orU+eqyFMWdwA=="
            crossorigin="anonymous">
        <link rel="stylesheet" href="static/dataTables.bootstrap.min.css"
            integrity="sha512-hs1f667XhSY60xOFaCeT+8zwrnG/QnsWLiO8e+56a+/vZWWKwBZ/tfXPDPiBl+3/lpuz7KCWmqbAM/cJWF6hAA=="
            crossorigin="anonymous">
        <script type="text/javascript" language="javascript" src="static/jquery-1.11.3.min.js"
            integrity="sha512-xAERw8wHVOkM9x9y9/FvQ7g1t+gIQj39mfkN1Rd1OLcC5k/x2e6NO8hq6qEbb3oO+CYYTjVLFiFYg5/7ddF0zA=="
            crossorigin="anonymous"></script>
        <script type="text/javascript" language="javascript" src="static/jquery.dataTables.min.js"
            integrity="sha512-Wdh8pTxAPpFPIMNSMGsM/TY1HOfGTswr68AnM9x0ZvemoEBUpQtg7ImSlBRuNO+WMtxwRknJUyb4gM8hSt8EVw=="
            crossorigin="anonymous"></script>
        <script type="text/javascript" language="javascript" src="static/bootstrap.min.js"
            integrity="sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A=="
            crossorigin="anonymous"></script>

        <link rel="stylesheet" href="static/bootstrap-dialog.min.css"
            integrity="sha512-NiSiBvckeLxY/WLKuEtzFVkUJpCe2XGWXxwUfD4Tk6/quYf+eaIZTtJfiyCTF6icvKg236kaRWbyObTC6O43MA=="
            crossorigin="anonymous">
        <script type="text/javascript" language="javascript" src="static/bootstrap-dialog.min.js"
            integrity="sha512-l2PkvHp95bWqdhM5gBfa18yRYVhTpUxuxyBgeuYawHw51YTkAQCdOsnTuQrEgp6pJLaFrCOaOvqKk3ctZ0O+gw=="
            crossorigin="anonymous"></script>

        <style type="text/css">
.paginate_button {
    display: inline-block;
    padding: 6px 12px;
    margin-bottom: 0;
    font-size: 14px;
    font-weight: 400;
    line-height: 1.42857143;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    -ms-touch-action: manipulation;
    touch-action: manipulation;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    background-image: none;
    border: 1px solid transparent;
    border-radius: 4px;
}
.current {
    background-image: -webkit-linear-gradient(top,#337ab7 0,#265a88 100%);
    background-image: -o-linear-gradient(top,#337ab7 0,#265a88 100%);
    background-image: -webkit-gradient(linear,left top,left bottom,from(#337ab7),to(#265a88));
    background-image: linear-gradient(to bottom,#337ab7 0,#265a88 100%);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff337ab7', endColorstr='#ff265a88', GradientType=0);
    filter: progid:DXImageTransform.Microsoft.gradient(enabled=false);
    color: white;
    background-repeat: repeat-x;
    border-color: #245580;
}
#logo {
    height: 6em;
}
#main {
    margin-top: 2em;
}
        </style>

    </head>
    <body>
        <div id="main" class="container">
            <div class="row">
                <div class="col-xs-8">
                    <h1>The Cargo Port</h1>
                    <h4>Galactic Distribution Center</h4>
                </div>
                <div class="col-xs-4" style="text-align:right">
                    <img id="logo" src="media/cpc-plain-small.png" />
                </div>
            </div>
            <hr/>
            <p>
                This package cache serves to preserve packages permanently. Please
                see our <a href="https://github.com/galaxyproject/cargo-port">Github Repository</a>
                for more information.
            </p>
            <p>
                The <a href="https://jenkins.galaxyproject.org/view/Meta/job/cargo-port/">Galaxy Jenkins Bot</a>
                compiles this webpage from  the github repository.
            </p>
            <h3>How to Use This</h3>
            <p>
                You can use the following command to download
                packages from this repository:

                <pre>curl --silent https://raw.githubusercontent.com/galaxyproject/cargo-port/master/gsl.py | python - --package_id augustus_3_1</pre>
            </p>
            <h3>Verifying URLs</h3>
            <p>
                The CPC ships an SHA256SUM file per package download.
                Downloaded files can be validated with the following command:

                <pre>LC_ALL=C sha256sum -c SHA256SUM 2>/dev/null | grep -v 'FAILED open or read'</pre>

                sha256sum has the <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1276664">unfortunate
                behaviour</a> of printing a lot of noise when files aren't found.
            </p>

            <h1>Cached URLs</h1>

            <table id="data" class="table table-striped">
                <thead>
                    <tr>
                        <th>Package ID</th>
                        <th>Package Version</th>
                        <th>Platform</th>
                        <th>Upstream Link</th>
                        <th>Help</th>
                    </tr>
                </thead>
            </table>


        </div>
        <script type="text/javascript">
            function showUsage(id, version, url, sha){
                BootstrapDialog.show({
                    title: 'How to use ' + id + '@' + version,
                    message: `<h3>Package tool_dependencies.xml</h3>
                        <pre>&lt;action type="download_by_url" sha256sum="${sha}"&gt;
    https://depot.galaxyproject.org/software/${url}
&lt;/action&gt;</pre>`
                });
            }
        </script>

        <script>
            $(document).ready(function() {
                $('#data').DataTable({
                    "ajax": "api.json",
                    "columnDefs": [
                        {
                            "targets": 0,
                            "data": "id",
                            "render": function ( data, type, full, meta  ) {
                                return '<a href="'+ data +'/">' + data + '</a>';
                            }
                        },
                        {
                             "targets": 1,
                             "data": "version",
                             "render": function(data, type, full, meta){
                                 return '<a href="' + full._gen + '">' + data + '</a>'
                             }
                        },
                        {
                             "targets": 2,
                             "data": "platform",
                             "render": function(data, type, full, meta){
                                 return data + '-' + full.arch;
                             }
                        },
                        {
                             "targets": 3,
                             "data": "url",
                             "render": function(data, type, full, meta){
                                 return '<a href="' + data + '">Link</a>';
                             }
                        },
                        {
                             "targets": 4,
                             "data": "id",
                             "render": function(data, type, full, meta){
                                 var showUsageCall = `<a onclick='showUsage("${full.id}", "${full.version}", "${full._gen}", "${full.sha}")'>
                                     <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                                     </a>
                                     `;
                                return showUsageCall;
                             }
                        }
                    ]
                });

            });
        </script>
    </body>
</html>
